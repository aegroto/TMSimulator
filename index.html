<head>
    <title>Turing Machine Simulator</title>
    <link rel="stylesheet" type="text/css" href="style.css"> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 

    <script src="utils.js"></script> 
    <script src="console.js"></script> 
    <script src="tmachine.js"></script> 
</head>
<body>
    <div id="container">
        <div id="bar-top">
            <button type="button" onclick="showExamples()">Examples</button>
            <button type="button" onclick="showHelp()">Help</button>
        </div>
        <div id="machine-container">
            <h1>Turing Machine Simulator</h1>
            <div id="define-form">
                    <div class="form-space">
                        <label>Input:</label>
                        <input id="input" type="text" name="input" size="35"/><br />
                    </div>
                    <div class="form-space">
                        <label>Definition:</label>
                        <input id="definition" type="text" name="definition" value="" size="55" /><br />
                    </div>
                    <div class="form-space">
                        <label>Transitions:</label>
                        <textarea id="transitions" cols="30" rows="15" name="transitions"></textarea><br />
                    </div>
                    <div class="form-space">
                        <label>Console:</label>
                        <textarea readonly id="console" cols="100" rows="15" name="console"></textarea><br />
                    </div>
                    <div class="form-space">
                        <button type="button" onclick="generateMachine()">Generate TM</button>
                        <button type="button" onclick="elaborateInputString()">Execute</button>
                        <button type="button" onclick="stopMachine()">Stop TM</button>
                        <button type="button" onclick="showOptions()">Options</button><br />

                        <button type="button" onclick="clearConsole()">Clear console</button>
                        <button type="button" onclick="printCurrentMachineOnConsole()">Debug TM</button>
                        <button type="button" onclick="showShareLink()">Share TM</button>
                    </div>
            </div>               
            <div id="advanced-space">
                <div id="share-space">
                    <textarea id="share-link-textarea" cols="100" rows="10" name="share-link"></textarea>
                    <button id="copy-button" type="button" onclick="copyShareLink()">Copy to clipboard</button>
                </div>
                <div id="options-space">
                    <label>Time per Step:</label>
                    <input id="steptime" type="text" name="steptime" value="50" size="10"/><br />
                    <label>Extended alphabet (leave blank to ignore):</label>
                    <input id="alphabet-extension" type="text" name="alphabet-extension" value="" size="30">
                </div>
            </div>
        </div>

        <div id="footer">
            <p>
            <a href="https://github.com/aegroto/">aegroto</a>
            - 2016 -
            <a href="https://github.com/aegroto/TMSimulator">Repository (on GitHub)</a>
            </p>
        </div>
    </div>    

    <script>
        clearConsole();

        var share_space=$("#share-space"),
            options_space=$("#options-space"),
            advanced_space=$("#advanced-space"),
            OPTIONS_STEPTIME,
            OPTIONS_ALPHABET_EXTENSION;

        /*$("#help-textarea").val("Help:\n"+
                       "\nGenerate TM: Generate Turing Machine with current settings."+
                       "\nExecute: Execute currently generated TM with the provided input string."+
                       "\nHelp: Show this."+
                       "\nClear console: Empty the console log."+
                       "\nDebug TM: Print to console settings of the current TM."+
                       "\nShare TM: Generates and shows a sharing link for the current settings.");*/
        showOptions();

        if(isConsoleEmpty()) consolePrint("Welcome!\nDefine your machine,click \"Generate TM\" and then \"Execute\" to let the TM elaborate the input string!");
        consolePrint("\n#####################################\n");

        $("#input").val("aaab");

        var hash_s=location.hash.substring(1,location.hash.length).replace(/"/g,"").split(";;;");
        
        if(hash_s.length>1 && hash_s[0]!=null && hash_s[0]!=undefined) {
            $("#definition").val(decodeURI(hash_s[0]));
            consolePrint("Imported definition from URL");
        } else {
            $("#definition").val("<{a,b},#,{q0,qF},q0,{qF},d>");
            consolePrint("No definition from URL or definition corrupted,setting it to default.");
        }

        if(hash_s.length>1 && hash_s[1]!=null && hash_s[1]!=undefined) {
            $("#transitions").val(decodeURI(hash_s[1]));
            consolePrint("Imported transitions from URL");
        } else {
            $("#transitions").val("<q0,a,q0,a,d>\n<q0,b,qF,#,d>\n<qF,a,qF,#,d>\n<qF,b,qF,#,d>");
            consolePrint("No transitions from URL or transitions corrupted,setting them to default.");
        }

        if(hash_s.length>1 && hash_s[2]!=null && hash_s[2]!=undefined) {
            OPTIONS_STEPTIME=decodeURI(hash_s[2]);
            consolePrint("Imported time per step from URL");
        } else {
            OPTIONS_STEPTIME="50";
            consolePrint("No time per step from URL or transitions corrupted,setting them to default.");
        }

        if(hash_s.length>1 && hash_s[3]!=null && hash_s[3]!=undefined) {
            OPTIONS_ALPHABET_EXTENSION=decodeURI(hash_s[3]);
            consolePrint("Imported alphabet extension from URL");
        } else {
            OPTIONS_ALPHABET_EXTENSION="";
            consolePrint("No alphabet extension from URL or transitions corrupted,setting them to default.");
        }

        $("#steptime").val(OPTIONS_STEPTIME);
        $("#alphabet-extension").val(OPTIONS_ALPHABET_EXTENSION);

        consolePrint("\n#####################################\n");
        generateMachine();
    </script>
</body>