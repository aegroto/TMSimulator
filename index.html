<head>
    <title>Turing Machine Simulator</title>
    <link rel="stylesheet" type="text/css" href="style.css"> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 

    <script src="utils.js"></script> 
    <script src="topbar_utils.js"></script> 
    <script src="console.js"></script> 
    <script src="tmachine.js"></script> 
</head>
<body>
    <div id="docs-space"> </div>
    <div id="help-page" class="docs-page hidden-docs-page">
            <h2>About</h2>
            <p>This Turing Machine simulator was made in November 2016 by aegroto @ <a href="https://itrench.surge.sh">itrench.surge.sh</a>. 
            It's still not finished,but it's constantly updated. If you find any issue, report it.</p>
            <h2>Known limitations</h2>
            <p>0)Multi-char symbols are not yet supported. Using more than a letter to define a symbol will probably not work.<br />
            1)Use R,L,I in transitions to make the tape move Right,Left or to not move. You still can't define your own letters on tape movements. It will be soon implemented.</p>
            
            <h2>Commands,definition and additional aptions</h2>
            <h3>Definition</h3>
            <p>
                At first,define your Turing Machine in the "Definition" space with this syntax:<br />
                <b>&#60&#931,#,Q,q0,F,d&#62</b><br />
                Where:<br /><br />
                &#931 = Alphabet<br />
                # = Blank character<br />
                Q = States<br />
                q0 = Initial state<br />
                F = Final states<br />
                d = Delta function<br />
                <br />
                Wrap every set in graphs {...}<br />
                Example:<b><{a,b},#,{q0,qF},q0,{qF},d></b>
            </p>
            <h3>Transitions</h3>
            <p>
                Transitions are defined as quintuples with this syntax:<br />
                <b> &#60q,c,q1,c1,r/l/i&#62 </b><br />
                That means:<br /><br />
                if the machine reads <b>c</b> while its state is <b>q</b>,goes to state <b>q1</b>,writes <b>c1</b> in the current cell and then moves <b>right/left/inherit (not move)</b> <br />
            </p>
            <h3>Commands description</h3>
            <p>
               <b>Generate TM</b>: Generate Turing Machine with current settings <u>(make sure Advanced Options are shown and not the Share Link is)</u>.<br>
               <b>Execute</b>: Execute currently generated TM with the provided input string.<br>
               <b>Options</b>: Show advanced options.<br>
               <b>Clear console</b>: Empty the console log.<br>
               <b>Debug TM</b>: Print to console settings of the current TM.<br>
               <b>Share TM</b>: Generates and shows a sharing link for the current settings.
            </p>
    </div>
    <div id="examples-page" class="docs-page hidden-docs-page">
        <p>
            <a href="https://aegroto-tms.surge.sh#%3C%7Ba,b%7D,#,%7Bq0,qF%7D,q0,%7BqF%7D,d%3E;;;%3Cq0,a,q0,a,r%3E%0A%3Cq0,b,qF,#,r%3E%0A%3CqF,a,qF,#,r%3E%0A%3CqF,b,qF,#,r%3E;;;100;;;;;;">
                Example 1 - accepts every string of {a,b}* that contains at least one 'b'
            </a><br />
        </p> 
    </div>

    <div id="container">
        <div id="bar-top">
            <button type="button" onclick="switchExamplesPage()">Examples</button>
            <button type="button" onclick="switchHelpPage()">Help</button>
        </div>
        <div id="machine-container">
            <h1>Turing Machine Simulator</h1>
            <div id="define-form">
                    <div class="form-space">
                        <label>Input:</label>
                        <input id="input" type="text" name="input" size="35"/><br />
                    </div>
                    <div class="form-space">
                        <label>Definition:</label>
                        <input id="definition" type="text" name="definition" value="" size="55" /><br />
                    </div>
                    <div class="form-space">
                        <label>Transitions:</label>
                        <textarea id="transitions" cols="30" rows="15" name="transitions"></textarea><br />
                    </div>
                    <div class="form-space">
                        <label>Console:</label>
                        <textarea readonly id="console" cols="100" rows="15" name="console"></textarea><br />
                    </div>
                    <div class="form-space">
                        <button type="button" onclick="generateMachine()">Generate TM</button>
                        <button type="button" onclick="elaborateInputString()">Execute</button>
                        <button type="button" onclick="stopMachine()">Stop TM</button>
                        <button type="button" onclick="showOptions()">Options</button><br />

                        <button type="button" onclick="clearConsole()">Clear console</button>
                        <button type="button" onclick="printCurrentMachineOnConsole()">Debug TM</button>
                        <button type="button" onclick="showShareLink()">Share TM</button>
                    </div>
            </div>               
            <div id="advanced-space">
                <div id="share-space">
                    <textarea id="share-link-textarea" cols="100" rows="10" name="share-link"></textarea>
                    <button id="copy-button" type="button" onclick="copyShareLink()">Copy to clipboard</button>
                </div>
                <div id="options-space">
                    <label>Time per Step:</label>
                    <input id="steptime" type="text" name="steptime" value="50" size="10"/><br />
                    <label>Extended alphabet (leave blank to ignore):</label>
                    <input id="alphabet-extension" type="text" name="alphabet-extension" value="" size="30">
                </div>
            </div>
        </div>

        <div id="footer">
            <p>
            <a href="https://github.com/aegroto/">aegroto</a>
            - 2016 -
            <a href="https://github.com/aegroto/TMSimulator">Repository (on GitHub)</a>
            </p>
        </div>
    </div>    

    <script>
        clearConsole();

        var body=$("body"),
            //Share space
            share_space=$("#share-space"),
            options_space=$("#options-space"),
            advanced_space=$("#advanced-space"),

            //Docs space
            docs_space=$("#docs-space"),
            help_page=$("#help-page"),
            examples_page=$("#examples-page"),
            //Options vars
            OPTIONS_STEPTIME,
            OPTIONS_ALPHABET_EXTENSION;

        help_page.css("position","absolute");
        examples_page.css("position","absolute");

        docs_space.click(function() {
            switchDocsSpace();
        });

        showOptions();

        if(isConsoleEmpty()) consolePrint("Welcome!\nDefine your machine,click \"Generate TM\" and then \"Execute\" to let the TM elaborate the input string!");
        consolePrint("\n#####################################\n");

        $("#input").val("aaabbb");

        var hash_s=location.hash.substring(1,location.hash.length).replace(/"/g,"").split(";;;");
        
        if(hash_s.length>1 && hash_s[0]!=null && hash_s[0]!=undefined) {
            $("#definition").val(decodeURI(hash_s[0]));
            consolePrint("Imported definition from URL");
        } else {
            $("#definition").val("<{a,b},#,{q0,qF},q0,{qF},d>");
            consolePrint("No definition from URL or definition corrupted,setting it to default.");
        }

        if(hash_s.length>1 && hash_s[1]!=null && hash_s[1]!=undefined) {
            $("#transitions").val(decodeURI(hash_s[1]));
            consolePrint("Imported transitions from URL");
        } else {
            $("#transitions").val("<q0,a,q0,a,r>\n<q0,b,qF,#,r>");
            consolePrint("No transitions from URL or transitions corrupted,setting them to default.");
        }

        if(hash_s.length>1 && hash_s[2]!=null && hash_s[2]!=undefined) {
            OPTIONS_STEPTIME=decodeURI(hash_s[2]);
            consolePrint("Imported time per step from URL");
        } else {
            OPTIONS_STEPTIME="100";
            consolePrint("No time per step from URL or transitions corrupted,setting them to default.");
        }

        if(hash_s.length>1 && hash_s[3]!=null && hash_s[3]!=undefined) {
            OPTIONS_ALPHABET_EXTENSION=decodeURI(hash_s[3]);
            consolePrint("Imported alphabet extension from URL");
        } else {
            OPTIONS_ALPHABET_EXTENSION="";
            consolePrint("No alphabet extension from URL or transitions corrupted,setting them to default.");
        }

        $("#steptime").val(OPTIONS_STEPTIME);
        $("#alphabet-extension").val(OPTIONS_ALPHABET_EXTENSION);

        consolePrint("\n#####################################\n");
        generateMachine();
    </script>
</body>